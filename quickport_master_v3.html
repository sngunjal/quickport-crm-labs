<!doctype html>
<html lang="en" data-theme="quickport">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Quickport CRM — v3_master (Labs) Registration + Dashboard</title>
  <link rel="icon" href="/assets/Quickport-CRM-LOGO-2.png" />
  <meta name="color-scheme" content="light dark" />
  <style>
    :root {
      /* Brandable palette derived from logo (tweakable) */
      --qp-primary: 268 86% 54%; /* primary purple */
      --qp-primary-2: 266 86% 44%; /* deeper purple */
      --qp-accent: 270 100% 70%; /* accent tint */
      --qp-bg: 258 25% 7%; /* deep slate for contrast */
      --qp-surface: 0 0% 100%;
      --qp-surface-2: 250 23% 13%;
      --qp-text: 0 0% 98%;
      --qp-text-muted: 0 0% 82%;
      --qp-success: 150 75% 38%;
      --qp-danger: 0 82% 54%;
      --qp-warning: 42 95% 55%;
      --ring: hsl(var(--qp-accent));

      --radius: 14px;
      --shadow-1: 0 10px 30px hsla(268, 70%, 45%, 0.26);
      --shadow-2: 0 6px 20px rgba(0,0,0,0.25);

      --focus: 0 0 0 3px hsl(var(--qp-accent) / 0.5);
    }

    @media (prefers-color-scheme: light) {
      :root {
        --qp-bg: 255 100% 99%;
        --qp-surface: 0 0% 100%;
        --qp-text: 250 22% 10%;
        --qp-text-muted: 250 12% 35%;
      }
    }

    /* Global resets */
    *, *::before, *::after { box-sizing: border-box; }
    html, body { height: 100%; }
    body {
      margin: 0;
      font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Helvetica Neue", Arial, "Apple Color Emoji", "Segoe UI Emoji";
      background: linear-gradient(135deg, hsl(var(--qp-primary)/0.18), hsl(var(--qp-primary-2)/0.18)), linear-gradient(180deg, hsl(var(--qp-bg)), hsl(var(--qp-bg)) 42%, hsl(var(--qp-bg)/0.96));
      color: hsl(var(--qp-text));
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }

    a { color: hsl(var(--qp-accent)); text-decoration: none; }
    a:hover { text-decoration: underline; }

    .container { max-width: 1200px; margin-inline: auto; padding: 20px; }

    header {
      position: sticky; top: 0; z-index: 40;
      background: linear-gradient(180deg, hsl(var(--qp-bg)/0.9), transparent);
      backdrop-filter: saturate(140%) blur(10px);
      border-bottom: 1px solid hsl(0 0% 100% / 0.06);
    }
    .nav { display: flex; align-items: center; justify-content: space-between; gap: 16px; }
    .brand { display: flex; align-items: center; gap: 12px; }
    .brand img { width: 40px; height: 40px; object-fit: contain; border-radius: 8px; }
    .brand .title { font-weight: 800; letter-spacing: 0.6px; }

    .login-link { color: hsl(var(--qp-text)); opacity: 0.9; }

    .hero {
      display: grid; gap: 24px; align-items: start;
      grid-template-columns: 1fr; padding-block: 22px; /* Mobile-first: form first */
    }

    /* Card */
    .card { background: hsl(var(--qp-surface)); color: #18181b; border-radius: var(--radius); padding: 20px; box-shadow: var(--shadow-2); border: 1px solid #eaeaf0; }
    .card.dark { background: hsl(var(--qp-surface-2)); color: hsl(var(--qp-text)); border: 1px solid hsl(0 0% 100% / 0.06); }

    .hero-left { order: 2; }
    .hero-right { order: 1; }

    @media (min-width: 960px) {
      .hero { grid-template-columns: 1.1fr 0.9fr; gap: 30px; padding-block: 46px; }
      .hero-left { order: 1; }
      .hero-right { order: 2; }
    }

    .headline { font-size: clamp(28px, 3.6vw, 46px); font-weight: 900; line-height: 1.05; letter-spacing: 0.2px; }
    .subhead { font-size: clamp(14px, 1.5vw, 18px); opacity: 0.9; margin-top: 10px; max-width: 56ch; }

    .badge-row { display: flex; gap: 10px; flex-wrap: wrap; margin-top: 14px; }
    .badge { font-size: 12px; padding: 6px 10px; border-radius: 999px; border: 1px solid hsl(0 0% 100% / 0.16); color: hsl(var(--qp-text)); background: linear-gradient(180deg, hsl(var(--qp-primary)/0.18), transparent); }

    .benefits { display: grid; gap: 10px; margin-top: 18px; }
    .benefits .item { display: flex; gap: 10px; align-items: start; }
    .icon-dot { width: 10px; height: 10px; border-radius: 3px; background: linear-gradient(135deg, hsl(var(--qp-primary)), hsl(var(--qp-primary-2))); margin-top: 7px; box-shadow: var(--shadow-1); }

    /* Inputs */
    .field { margin-bottom: 12px; }
    .label { display: flex; justify-content: space-between; gap: 8px; font-size: 13px; font-weight: 600; color: #334155; }
    .label.dark { color: hsl(var(--qp-text)); opacity: 0.9; }
    .help { font-size: 12px; color: #64748b; }
    .help.dark { color: hsl(var(--qp-text-muted)); }
    .error { font-size: 12px; color: #b91c1c; margin-top: 6px; }
    .input, .select { width: 100%; padding: 12px 12px; border-radius: 10px; border: 1px solid #e5e7eb; background: #fff; color: #111827; outline: none; box-shadow: 0 1px 0 rgba(0,0,0,0.02) inset; }
    .dark .input, .dark .select { background: hsl(var(--qp-surface-2)); color: hsl(var(--qp-text)); border-color: hsl(0 0% 100% / 0.08); }
    .input:focus, .select:focus { border-color: transparent; box-shadow: var(--focus); }

    .row { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
    @media (max-width: 480px) { .row { grid-template-columns: 1fr; } }

    .btn {
      display: inline-flex; align-items: center; justify-content: center; gap: 8px;
      padding: 12px 16px; border-radius: 12px; border: none; cursor: pointer; font-weight: 700; letter-spacing: 0.2px;
      background: linear-gradient(135deg, hsl(var(--qp-primary)), hsl(var(--qp-primary-2)));
      color: white; box-shadow: var(--shadow-1);
      transition: background 200ms ease, transform 120ms ease, box-shadow 200ms ease;
    }
    .btn:hover { transform: translateY(-1px); box-shadow: 0 14px 34px hsla(268, 80%, 40%, 0.32); }
    .btn:disabled { opacity: 0.6; cursor: not-allowed; }
    .btn-secondary { background: transparent; color: hsl(var(--qp-text)); border: 1px solid hsl(0 0% 100% / 0.18); box-shadow: none; }

    .switch { appearance: none; width: 46px; height: 26px; background: #e5e7eb; border-radius: 999px; position: relative; outline: none; border: 1px solid #e5e7eb; cursor: pointer; }
    .switch:checked { background: hsl(var(--qp-primary)); border-color: hsl(var(--qp-primary-2)); }
    .switch::after { content: ""; position: absolute; top: 2px; left: 2px; width: 20px; height: 20px; background: white; border-radius: 999px; transition: left 160ms ease; }
    .switch:checked::after { left: 24px; }

    /* OTP dialog */
    dialog[open] { display: block; }
    .modal::backdrop { background: rgba(3, 5, 16, 0.58); backdrop-filter: blur(2px); }
    .modal { border: none; padding: 0; border-radius: 18px; width: min(520px, 94vw); }
    .modal .content { padding: 18px; background: hsl(var(--qp-surface)); color: #111827; border-radius: 18px; border: 1px solid #eaeaf0; }
    .dark .modal .content { background: hsl(var(--qp-surface-2)); border: 1px solid hsl(0 0% 100% / 0.08); color: hsl(var(--qp-text)); }

    .modal-header { display: flex; align-items: start; justify-content: space-between; gap: 8px; }
    .modal-title { font-size: 18px; font-weight: 800; }
    .modal-body { margin-top: 12px; }
    .otp-grid { display: grid; grid-template-columns: repeat(6, 1fr); gap: 10px; }
    .otp-input { text-align: center; font-size: 22px; font-weight: 800; padding: 14px 0; border-radius: 12px; border: 1px solid #e5e7eb; background: #fff; color: #111827; }
    .dark .otp-input { background: hsl(var(--qp-surface-2)); color: hsl(var(--qp-text)); border-color: hsl(0 0% 100% / 0.08); }
    .otp-actions { display: flex; align-items: center; justify-content: space-between; gap: 10px; margin-top: 10px; }

    .badges { display: flex; gap: 8px; flex-wrap: wrap; }
    .mini-badge { font-size: 11px; padding: 4px 8px; border-radius: 999px; border: 1px solid #e5e7eb; background: #fff; color: #111827; }
    .dark .mini-badge { border-color: hsl(0 0% 100% / 0.12); background: hsl(var(--qp-surface-2)); color: hsl(var(--qp-text)); }

    .modal-footer { margin-top: 14px; font-size: 12px; opacity: 0.9; }

    .tooltip { position: relative; }
    .tooltip [role="tooltip"] { position: absolute; left: 0; top: calc(100% + 8px); min-width: 260px; max-width: 460px; background: #111827; color: #f8fafc; padding: 10px 12px; border-radius: 10px; box-shadow: 0 10px 24px rgba(0,0,0,0.35); font-size: 12px; line-height: 1.25; display: none; z-index: 20; }
    .tooltip:focus-within [role="tooltip"], .tooltip:hover [role="tooltip"] { display: block; }

    /* Sections */
    section { padding-block: 26px; }
    .section-title { font-weight: 900; font-size: 22px; margin-bottom: 12px; }

    .grid { display: grid; gap: 12px; }
    .grid.cols-3 { grid-template-columns: repeat(3, 1fr); }
    .grid.cols-4 { grid-template-columns: repeat(4, 1fr); }
    .grid.cols-2 { grid-template-columns: repeat(2, 1fr); }
    @media (max-width: 960px) { .grid.cols-3, .grid.cols-4 { grid-template-columns: repeat(2, 1fr); } }
    @media (max-width: 560px) { .grid.cols-2, .grid.cols-3, .grid.cols-4 { grid-template-columns: 1fr; } }

    .feature-card { background: hsl(var(--qp-surface)); color: #111827; border-radius: 14px; padding: 14px; border: 1px solid #eaeaf0; }
    .dark .feature-card { background: hsl(var(--qp-surface-2)); color: hsl(var(--qp-text)); border: 1px solid hsl(0 0% 100% / 0.08); }
    .feature-card button { width: 100%; background: transparent; border: none; color: inherit; text-align: left; font-weight: 700; padding: 0; cursor: pointer; }
    .feature-desc { margin-top: 8px; font-size: 13px; color: #334155; }
    .dark .feature-desc { color: hsl(var(--qp-text-muted)); }

    .pricing { position: relative; }
    .ribbon { position: absolute; top: -8px; left: 0; background: linear-gradient(135deg, hsl(var(--qp-primary)), hsl(var(--qp-primary-2))); color: white; padding: 6px 10px; font-size: 12px; font-weight: 800; border-radius: 0 8px 8px 0; box-shadow: var(--shadow-1); }
    .plan { background: hsl(var(--qp-surface)); color: #111827; border-radius: 16px; padding: 16px; border: 1px solid #eaeaf0; display: flex; flex-direction: column; gap: 10px; }
    .dark .plan { background: hsl(var(--qp-surface-2)); color: hsl(var(--qp-text)); border: 1px solid hsl(0 0% 100% / 0.08); }
    .price { font-size: 26px; font-weight: 900; }
    .features { font-size: 13px; display: grid; gap: 6px; }

    .docs details { background: hsl(var(--qp-surface)); color: #111827; border-radius: 14px; padding: 12px; border: 1px solid #eaeaf0; }
    .dark .docs details { background: hsl(var(--qp-surface-2)); color: hsl(var(--qp-text)); border: 1px solid hsl(0 0% 100% / 0.08); }
    .doc-row { display: grid; grid-template-columns: 1fr auto; align-items: center; gap: 8px; padding: 8px 0; border-bottom: 1px dashed #e5e7eb; }
    .doc-row:last-child { border-bottom: none; }

    /* Contact FAB */
    .fab { position: fixed; right: 18px; bottom: 18px; width: 56px; height: 56px; border-radius: 999px; border: none; background: linear-gradient(135deg, hsl(var(--qp-primary)), hsl(var(--qp-primary-2))); color: white; box-shadow: var(--shadow-1); cursor: pointer; z-index: 40; }
    .fab:hover { transform: translateY(-1px); }

    .fab-card { position: fixed; right: 18px; bottom: 86px; width: min(360px, 94vw); background: hsl(var(--qp-surface)); color: #111827; border: 1px solid #eaeaf0; border-radius: 14px; padding: 12px; box-shadow: var(--shadow-2); display: none; z-index: 40; }
    .dark .fab-card { background: hsl(var(--qp-surface-2)); color: hsl(var(--qp-text)); border: 1px solid hsl(0 0% 100% / 0.08); }
    .fab-card.open { display: block; }

    .toast { position: fixed; left: 50%; transform: translateX(-50%); bottom: 14px; background: #0b0f1a; color: #e6edf6; padding: 10px 14px; border-radius: 999px; box-shadow: 0 10px 28px rgba(0,0,0,0.34); font-size: 13px; display: none; z-index: 60; }
    .toast.show { display: inline-flex; }

    footer { border-top: 1px solid hsl(0 0% 100% / 0.1); padding-block: 16px; font-size: 12px; opacity: 0.9; }

    @media (prefers-reduced-motion: reduce) {
      * { transition: none !important; animation: none !important; }
    }
  </style>
</head>
<body class="dark">
  <a class="skip-link" href="#main" style="position:absolute;left:-10000px;top:auto;width:1px;height:1px;overflow:hidden;">Skip to content</a>
  <header role="banner">
    <div class="container nav" aria-label="Top Navigation">
      <div class="brand">
        <img src="/assets/Quickport-CRM-LOGO-2.png" alt="Quickport CRM logo" />
        <div class="title" aria-label="Product name">Quickport CRM</div>
      </div>
      <nav aria-label="Primary">
        <a class="login-link" href="#" id="loginLink">Login</a>
      </nav>
    </div>
  </header>

  <main id="main" class="container" role="main">
    <section class="hero" aria-label="Registration hero">
      <!-- Right: Registration (mobile-first) -->
      <div class="hero-right">
        <div class="card dark" aria-labelledby="regTitle">
          <h2 id="regTitle" style="margin:0 0 8px 0; font-size:18px; font-weight:900;">Start your pilot — India SMS OTP on DLT templates</h2>
          <p class="help dark" style="margin-top:0">Fields marked * are required. WhatsApp OTP is disabled for MVP; SMS on DLT-approved templates is active.</p>

          <form id="regForm" novalidate autocomplete="on" aria-describedby="regHelp">
            <div class="field">
              <label class="label dark" for="businessName">Business Name*</label>
              <input class="input" id="businessName" name="businessName" type="text" required maxlength="120" autocomplete="organization" aria-describedby="businessNameHelp businessNameErr" />
              <div id="businessNameHelp" class="help dark">Your legal/trade name. Max 120 characters.</div>
              <div id="businessNameErr" class="error" aria-live="polite"></div>
            </div>

            <div class="field">
              <div class="label dark">Phone Number* <span class="help dark">E.164 — Example: +919876543210</span></div>
              <div class="row">
                <select class="select" id="country" name="country" aria-label="Country code" disabled>
                  <option value="IN" selected>IN +91 (locked for MVP)</option>
                </select>
                <input class="input" id="phone" name="phone" type="tel" inputmode="numeric" pattern="^\+91[6-9]\d{9}$" placeholder="+919876543210" required autocomplete="tel" aria-describedby="phoneHelp phoneErr" />
              </div>
              <div id="phoneHelp" class="help dark">Must match +91 followed by 10 digits starting 6–9.</div>
              <div id="phoneErr" class="error" aria-live="polite"></div>
            </div>

            <div class="field">
              <label class="label dark" for="email">Email Address*</label>
              <input class="input" id="email" name="email" type="email" required autocomplete="email" aria-describedby="emailHelp emailErr" />
              <div id="emailHelp" class="help dark">We’ll use this for receipts and communications.</div>
              <div id="emailErr" class="error" aria-live="polite"></div>
            </div>

            <div class="field" style="display:flex;align-items:center;gap:10px;">
              <input class="switch" id="toggleEmailOtp" type="checkbox" role="switch" aria-checked="false" aria-label="Verify email too (optional)" />
              <label for="toggleEmailOtp" class="help dark" style="margin:0;">Verify email too (optional)</label>
            </div>

            <div class="field" style="display:flex;align-items:center;gap:10px;">
              <input class="switch" id="toggleWhatsapp" type="checkbox" role="switch" disabled aria-checked="false" aria-label="WhatsApp OTP disabled" />
              <label for="toggleWhatsapp" class="help dark" style="margin:0;">WhatsApp OTP: disabled for MVP</label>
            </div>

            <button class="btn" id="submitBtn" type="submit" aria-live="polite">
              <span id="submitText">Request SMS OTP</span>
              <span id="submitSpinner" aria-hidden="true" style="display:none">⏳</span>
            </button>
            <div id="regHelp" class="help dark" style="margin-top:8px;">Your request uses Service‑Implicit DLT templates. We never store MSG91 tokens on the client.</div>
          </form>
        </div>
      </div>

      <!-- Left: Value proposition -->
      <div class="hero-left" aria-label="Product highlights">
        <div class="badge-row">
          <span class="badge" title="All sends follow India DLT rules">SMS on DLT</span>
          <span class="badge" title="WhatsApp OTP temporarily off">WhatsApp OTP: disabled</span>
          <span class="badge" title="Strict E.164 validation enforced">E.164: +91 only</span>
        </div>
        <h1 class="headline" style="margin-top:12px;">QUICKPORT CRM</h1>
        <p class="subhead">In today’s markets, AI‑driven CRM isn’t optional — it’s how small teams deliver enterprise‑grade automation.</p>
        <div class="benefits" aria-label="Automation benefits">
          <div class="item"><span class="icon-dot" aria-hidden="true"></span><span>AI assistants and automation beyond CRM — cloud‑native, open architecture</span></div>
          <div class="item"><span class="icon-dot" aria-hidden="true"></span><span>Onboarding, scheduling, reminders, analytics, and LLM copilots</span></div>
          <div class="item"><span class="icon-dot" aria-hidden="true"></span><span>Built for Indian Tutors MVP — scalable to all industries</span></div>
        </div>
      </div>
    </section>

    <!-- What you get -->
    <section aria-labelledby="featuresTitle">
      <h2 id="featuresTitle" class="section-title">What you get</h2>
      <div class="grid cols-4" id="featuresGrid">
        <!-- Items generated by script for brevity and easy edits -->
      </div>
    </section>

    <!-- Pricing -->
    <section class="pricing" aria-labelledby="pricingTitle">
      <div class="ribbon" aria-hidden="true">Indian Tutors MVP Focus</div>
      <h2 id="pricingTitle" class="section-title">Pricing</h2>
      <div class="grid cols-3" id="pricingGrid"></div>
      <p class="help dark" style="margin-top:8px;">Plans may change. OTP remains SMS‑first for MVP; WhatsApp messaging available as shared/own number for campaigns.</p>
    </section>

    <!-- Reference Docs -->
    <section class="docs" aria-labelledby="docsTitle">
      <h2 id="docsTitle" class="section-title">Quickport CRM Reference Docs & Literature</h2>
      <details open>
        <summary style="font-weight:800; cursor:pointer;">Open resources</summary>
        <div id="docsList" style="margin-top:10px;">
          <!-- Rows generated by script (editable, removable) -->
        </div>
        <button class="btn-secondary" id="addDocBtn" type="button" style="padding:8px 10px;border-radius:10px;margin-top:8px;">Add placeholder link</button>
        <p class="help dark" style="margin-top:8px;">Default links point to “#”. Adding copyrighted files requires permission; later you can link to public sources.</p>
      </details>
    </section>
  </main>

  <!-- OTP Modal -->
  <dialog id="otpDialog" class="modal" role="dialog" aria-modal="true" aria-labelledby="otpTitle" aria-describedby="otpDesc">
    <form method="dialog" class="content" id="otpFormShell">
      <div class="modal-header">
        <div>
          <div class="modal-title" id="otpTitle">Verify your mobile number (DLT‑approved SMS)</div>
          <p id="otpDesc" class="help dark" style="margin:6px 0 0 0;">Enter the 6‑digit code we sent to your phone. OTP valid for 5 minutes. Attempts: <span id="attemptsLeft">5</span>.</p>
          <div class="badges" style="margin-top:8px;">
            <span class="mini-badge" id="badgeDLT" title="DLT template mapped and used">DLT template in use</span>
            <span class="mini-badge" id="badgeToken" title="Server verified provider token">Secure token verified server‑side</span>
          </div>
        </div>
        <button type="button" class="btn-secondary" id="closeOtpBtn" aria-label="Close OTP dialog">Close</button>
      </div>

      <div class="modal-body">
        <div class="otp-grid" role="group" aria-label="One time passcode inputs">
          <input class="otp-input" inputmode="numeric" pattern="\\d*" autocomplete="one-time-code" aria-label="Digit 1" maxlength="1" />
          <input class="otp-input" inputmode="numeric" pattern="\\d*" autocomplete="one-time-code" aria-label="Digit 2" maxlength="1" />
          <input class="otp-input" inputmode="numeric" pattern="\\d*" autocomplete="one-time-code" aria-label="Digit 3" maxlength="1" />
          <input class="otp-input" inputmode="numeric" pattern="\\d*" autocomplete="one-time-code" aria-label="Digit 4" maxlength="1" />
          <input class="otp-input" inputmode="numeric" pattern="\\d*" autocomplete="one-time-code" aria-label="Digit 5" maxlength="1" />
          <input class="otp-input" inputmode="numeric" pattern="\\d*" autocomplete="one-time-code" aria-label="Digit 6" maxlength="1" />
        </div>
        <div id="otpErr" class="error" aria-live="polite" style="margin-top:8px;"></div>
        <div class="otp-actions">
          <div class="help dark">Resend in <span id="countdown">30</span>s</div>
          <div style="display:flex;gap:8px;">
            <button type="button" class="btn-secondary" id="resendBtn" disabled>Resend OTP</button>
            <button type="button" class="btn" id="verifyBtn">Verify</button>
          </div>
        </div>
        <div class="help dark" style="margin-top:10px;">
          Template used for OTP: “Quickport: Your verification code is {#var#}. Valid for {#var#} minutes. Do not share.”
          <span class="tooltip">
            <button type="button" class="btn-secondary" aria-describedby="dltTip" style="padding:4px 8px;border-radius:8px;">learn more</button>
            <span id="dltTip" role="tooltip">India requires operator‑approved templates with {#var#} placeholders and mapped Sender IDs (Headers); OTP/login and service messages use Service‑Implicit unless you are a bank (Transactional); the backend rejects any SMS lacking an approved template ID + header.</span>
          </span>
        </div>
      </div>

      <div class="modal-footer">
        <div class="tooltip">
          <button type="button" class="btn-secondary" aria-describedby="secTip" style="padding:4px 8px;border-radius:8px;">Security model</button>
          <div id="secTip" role="tooltip">Protected APIs require Authorization: Bearer &lt;JWT&gt; (RFC 6750). This page runs pre‑registration open endpoints for SMS OTP only. Any demo token is stored locally for demo purposes only.</div>
        </div>
        <div class="help dark" style="margin-top:6px;">MSG91: server verifies widget access‑token and maps DLT Template ID to flow; client only hits /api endpoints over HTTPS.</div>
      </div>
    </form>
  </dialog>

  <!-- Email OTP (mock) -->
  <dialog id="emailDialog" class="modal" role="dialog" aria-modal="true" aria-labelledby="emailOtpTitle" aria-describedby="emailOtpDesc">
    <form method="dialog" class="content">
      <div class="modal-header">
        <div>
          <div class="modal-title" id="emailOtpTitle">Optional: verify your email</div>
          <p id="emailOtpDesc" class="help dark" style="margin:6px 0 0 0;">We’ll send a 6‑digit code to your email. For MVP this step may be mocked.</p>
        </div>
        <button type="button" class="btn-secondary" id="closeEmailBtn" aria-label="Close email dialog">Close</button>
      </div>
      <div class="modal-body">
        <div class="help dark">Mock mode: Email OTP auto‑approves for demos. No provider traffic is sent.</div>
        <div style="display:flex;gap:8px;margin-top:10px;">
          <button type="button" class="btn" id="emailVerifyOk">Looks good</button>
        </div>
      </div>
    </form>
  </dialog>

  <!-- Dashboard shell (hidden until verified) -->
  <section id="dashboardShell" class="container" hidden aria-labelledby="dashTitle">
    <h2 id="dashTitle" class="section-title">Welcome to your Dashboard</h2>
    <p class="help dark">Protected routes require Authorization: Bearer &lt;JWT&gt;. Tokens are validated server‑side over HTTPS. This shell simulates session persistence for demo.</p>
    <div class="grid cols-3">
      <div class="feature-card"><strong>Leads</strong><div class="feature-desc">Track acquisition and nurturing funnels with automation rules.</div></div>
      <div class="feature-card"><strong>Appointments</strong><div class="feature-desc">Scheduling, confirmations, and rescheduling with reminders.</div></div>
      <div class="feature-card"><strong>Analytics</strong><div class="feature-desc">KPI dashboards with ROI and churn indicators.</div></div>
    </div>
  </section>

  <!-- Contact FAB + card -->
  <button class="fab" id="fabBtn" aria-label="Open contact form">✉</button>
  <div class="fab-card dark" id="fabCard" role="dialog" aria-modal="false" aria-labelledby="fabTitle">
    <div style="display:flex;align-items:center;justify-content:space-between;gap:8px;">
      <div id="fabTitle" style="font-weight:800;">Contact Quickport</div>
      <button class="btn-secondary" id="fabClose" type="button" aria-label="Close contact form">Close</button>
    </div>
    <form id="contactForm" style="margin-top:8px;">
      <div class="field">
        <label class="label dark" for="cBiz">Business Name</label>
        <input class="input" id="cBiz" required />
      </div>
      <div class="field">
        <label class="label dark" for="cType">Business Type</label>
        <input class="input" id="cType" />
      </div>
      <div class="field">
        <label class="label dark" for="cQ">Questions</label>
        <textarea class="input" id="cQ" rows="3"></textarea>
      </div>
      <div class="field">
        <label class="label dark" for="cContact">Contact Details</label>
        <input class="input" id="cContact" required />
      </div>
      <button class="btn" type="submit">Send</button>
    </form>
  </div>

  <div id="toast" class="toast" role="status" aria-live="polite">Sent!</div>

  <footer role="contentinfo" class="container">
    <div>UDYAM‑MH‑18‑0408716</div>
    <div style="margin-top:4px;">ISO/IEC 27001 certification process initiated; monitoring and controls aligned to platform policies and India DLT governance
      <span class="tooltip">
        <button type="button" class="btn-secondary" aria-describedby="govTip" style="padding:2px 6px;border-radius:8px;">?</button>
        <span id="govTip" role="tooltip">Templates and Headers are pre‑approved and mapped to sends before delivery in compliance with DLT requirements.</span>
      </span>
    </div>
  </footer>

  <script>
    // MOCK toggle per product brief. Flip at runtime via console: window.QP_MOCK = false
    window.QP_MOCK = true;

    // Accessibility helpers: focus trap for dialog
    function trapFocus(modal) {
      const focusable = modal.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])');
      const first = focusable[0];
      const last = focusable[focusable.length - 1];
      function keydown(e) {
        if (e.key === 'Tab') {
          if (e.shiftKey && document.activeElement === first) { e.preventDefault(); last.focus(); }
          else if (!e.shiftKey && document.activeElement === last) { e.preventDefault(); first.focus(); }
        }
        if (e.key === 'Escape') modal.close();
      }
      modal.addEventListener('keydown', keydown);
      return () => modal.removeEventListener('keydown', keydown);
    }

    const els = {
      regForm: document.getElementById('regForm'),
      businessName: document.getElementById('businessName'),
      phone: document.getElementById('phone'),
      email: document.getElementById('email'),
      submitBtn: document.getElementById('submitBtn'),
      submitText: document.getElementById('submitText'),
      submitSpinner: document.getElementById('submitSpinner'),
      bErr: document.getElementById('businessNameErr'),
      pErr: document.getElementById('phoneErr'),
      eErr: document.getElementById('emailErr'),
      otpDialog: document.getElementById('otpDialog'),
      otpInputs: null,
      countdown: document.getElementById('countdown'),
      resendBtn: document.getElementById('resendBtn'),
      verifyBtn: document.getElementById('verifyBtn'),
      otpErr: document.getElementById('otpErr'),
      attemptsLeft: document.getElementById('attemptsLeft'),
      badgeDLT: document.getElementById('badgeDLT'),
      badgeToken: document.getElementById('badgeToken'),
      closeOtpBtn: document.getElementById('closeOtpBtn'),
      toggleEmailOtp: document.getElementById('toggleEmailOtp'),
      emailDialog: document.getElementById('emailDialog'),
      closeEmailBtn: document.getElementById('closeEmailBtn'),
      emailVerifyOk: document.getElementById('emailVerifyOk'),
      dash: document.getElementById('dashboardShell'),
      loginLink: document.getElementById('loginLink'),
      // contact
      fabBtn: document.getElementById('fabBtn'),
      fabCard: document.getElementById('fabCard'),
      fabClose: document.getElementById('fabClose'),
      contactForm: document.getElementById('contactForm'),
      toast: document.getElementById('toast'),
      // sections
      featuresGrid: document.getElementById('featuresGrid'),
      pricingGrid: document.getElementById('pricingGrid'),
      docsList: document.getElementById('docsList'),
      addDocBtn: document.getElementById('addDocBtn'),
    };

    const state = {
      reqId: null,
      attempts: 0,
      maxAttempts: 5,
      otpLen: 6,
      cooldown: 30,
      timer: null,
      formCache: null,
      emailVerifyRequested: false,
    };

    // Utility: show toast
    function showToast(msg) {
      els.toast.textContent = msg; els.toast.classList.add('show');
      setTimeout(()=> els.toast.classList.remove('show'), 2000);
    }

    // Features list (concise copy, revealing micro‑explanations one at a time)
    const FEATURES = [
      {t:'New customer onboarding', d:'Automated welcome, forms, and guided steps for faster activation.'},
      {t:'Appointments', d:'Self‑serve scheduling, confirmations, rescheduling, and reminders.'},
      {t:'Payment reminders', d:'Timely nudges and semi‑automatic receipts with audit trails.'},
      {t:'3rd‑party integrations', d:'ERP/Accounting/Inventory via flexible APIs and connectors.'},
      {t:'Social sentiment', d:'FB/IG/LinkedIn/Telegram signals with lead nurturing hooks.'},
      {t:'Email automation', d:'Journeys, segmentation, and lead scoring with templates.'},
      {t:'Role‑based access', d:'Granular permissions, MFA readiness, and audit logs.'},
      {t:'Predictive analytics', d:'Forecasts, churn reduction, and KPI/ROI dashboards.'},
      {t:'LLM assistants', d:'Context‑aware copilots across support, sales, and ops.'},
      {t:'Support tickets', d:'Omnichannel intake with SLAs and escalation paths.'},
      {t:'Marketing studio', d:'Campaign orchestration with social tools and gamification.'},
      {t:'Bots (chat/voice/genAI)', d:'Assistive flows, IVR integration, and generative agents.'},
      {t:'Dynamic CMS', d:'Surveys, polls, reviews, and content personalization.'},
      {t:'E‑commerce & carts', d:'Recover abandoners and nudge to conversion.'},
      {t:'Healthcare/Call‑center', d:'IVR and agents tailored to regulated workflows.'},
      {t:'Security & privacy', d:'Encryption, MFA, RBAC, ISO‑27001 alignment in progress.'},
    ];

    function renderFeatures() {
      els.featuresGrid.innerHTML = '';
      FEATURES.forEach((f, i) => {
        const card = document.createElement('div');
        card.className = 'feature-card';
        card.innerHTML = `<button type="button" aria-expanded="false">${f.t}</button><div class="feature-desc" hidden>${f.d}</div>`;
        const btn = card.querySelector('button');
        const desc = card.querySelector('.feature-desc');
        btn.addEventListener('click', () => {
          // close others
          els.featuresGrid.querySelectorAll('.feature-desc').forEach(el => { el.hidden = true; });
          els.featuresGrid.querySelectorAll('.feature-card button').forEach(b => b.setAttribute('aria-expanded','false'));
          // open this
          desc.hidden = false; btn.setAttribute('aria-expanded','true');
        });
        els.featuresGrid.appendChild(card);
      });
    }

    // Pricing
    const PLANS = [
      {name:'Free Tier (Trial)', price:'₹0', notes:['Includes ₹50 credits','5 WhatsApp test messages','SMS‑first OTP for MVP','Shared number for WhatsApp tests','Wallet rates: SMS/WA per schedule']},
      {name:'Starter', price:'₹199/month', notes:['Core CRM + automation','Shared WA number messaging','SMS‑first OTP','Wallet rates apply']},
      {name:'Basic', price:'₹399/month', notes:['Adds email journeys','Shared/own WA number (opt‑in)','SMS‑first OTP','Wallet rates apply']},
      {name:'Growth', price:'₹599/month', notes:['Advanced analytics','Lead nurturing','Shared/own WA number','Wallet rates apply']},
      {name:'Professional', price:'₹799/month', notes:['Role‑based access','Integrations (ERP/Accounting)','Shared/own WA number','Wallet rates apply']},
      {name:'Enterprise', price:'₹1299/month', notes:['SLA & support','Custom onboarding','Own WA number','Wallet rates apply']},
    ];

    function renderPricing() {
      els.pricingGrid.className = 'grid cols-3';
      els.pricingGrid.innerHTML = '';
      PLANS.forEach(p => {
        const plan = document.createElement('div');
        plan.className = 'plan';
        plan.innerHTML = `<div style="font-weight:800;">${p.name}</div><div class="price">${p.price}</div><div class="features">${p.notes.map(n=>`<div>• ${n}</div>`).join('')}</div><button class="btn" type="button" style="margin-top:6px;">Choose</button>`;
        els.pricingGrid.appendChild(plan);
      });
    }

    // Docs list
    const DEFAULT_DOCS = [
      {t:'Product one‑pager (PDF)', d:'Overview of Quickport CRM for MVP pilots', href:'#'},
      {t:'Automation playbook (blog)', d:'Short reads on AI workflows in CRM', href:'#'},
      {t:'API quickstart (stub)', d:'Open architecture and flexible endpoints', href:'#'},
    ];

    function renderDocs() {
      els.docsList.innerHTML = '';
      DEFAULT_DOCS.forEach(addDocRow);
    }

    function addDocRow(doc) {
      const row = document.createElement('div');
      row.className = 'doc-row';
      row.innerHTML = `<div><a href="${doc.href}" aria-label="${doc.t}">${doc.t}</a><div class="help dark">${doc.d}</div></div><button class="btn-secondary" type="button" aria-label="Remove">Remove</button>`;
      row.querySelector('button').addEventListener('click', ()=> row.remove());
      els.docsList.appendChild(row);
    }

    els.addDocBtn.addEventListener('click', ()=> addDocRow({t:'New resource', d:'Short blurb', href:'#'}));

    // Validation helpers
    const PHONE_RE = /^\+91[6-9]\d{9}$/;
    function validate() {
      let ok = true;
      const b = els.businessName.value.trim();
      if (!b) { els.bErr.textContent = 'Business name is required'; ok = false; } else if (b.length > 120) { els.bErr.textContent = 'Max 120 characters'; ok = false; } else { els.bErr.textContent = ''; }
      const p = els.phone.value.trim();
      if (!p) { els.pErr.textContent = 'Phone is required'; ok = false; } else if (!PHONE_RE.test(p)) { els.pErr.textContent = 'Must match +91 followed by 10 digits starting 6–9'; ok = false; } else { els.pErr.textContent = ''; }
      const e = els.email.value.trim();
      if (!e) { els.eErr.textContent = 'Email is required'; ok = false; } else if (!els.email.checkValidity()) { els.eErr.textContent = 'Enter a valid email'; ok = false; } else { els.eErr.textContent = ''; }
      return ok;
    }

    function setSubmitting(on) {
      els.submitBtn.disabled = on; els.submitSpinner.style.display = on ? 'inline' : 'none'; els.submitText.textContent = on ? 'Submitting…' : 'Request SMS OTP';
    }

    function startCooldown(seconds) {
      let t = seconds; els.countdown.textContent = t; els.resendBtn.disabled = true;
      if (state.timer) clearInterval(state.timer);
      state.timer = setInterval(()=>{ t--; els.countdown.textContent = t; if (t <= 0) { clearInterval(state.timer); els.resendBtn.disabled = false; els.countdown.textContent = '0'; } }, 1000);
    }

    function getOtpValue() {
      return Array.from(els.otpInputs).map(i => i.value).join('');
    }

    function clearOtp() { Array.from(els.otpInputs).forEach(i => i.value=''); }

    // API helpers (relative /api per ingress rules).
    async function apiPost(path, body) {
      const res = await fetch(path, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(body) });
      if (!res.ok) throw new Error('Network error');
      return res.json();
    }

    // Mock responders
    function mockRequestOtp() {
      return new Promise(resolve => setTimeout(()=> resolve({ status:'success', reqId: 'mock-'+Date.now(), tokenVerified: true, templateId: 'DLT12345', header: 'QPORT' }), 700));
    }
    function mockVerifyOtp() {
      return new Promise((resolve, reject) => setTimeout(()=> {
        const otp = getOtpValue();
        if (otp === '000000') return reject({ status:'error', message:'Invalid OTP' });
        resolve({ status: 'success', user: { id:'u_'+Math.random().toString(36).slice(2), business: state.formCache.businessName }, token: 'demo-token-'+Math.random().toString(36).slice(2) });
      }, 600));
    }
    function mockRegister() {
      return new Promise(resolve => setTimeout(()=> resolve({ status:'success', user: { id:'u_'+Math.random().toString(36).slice(2), business: state.formCache.businessName }, token: 'demo-token-'+Math.random().toString(36).slice(2) }), 500));
    }

    // OTP modal wiring
    let untrap = null; let autofocusDone = false;
    function openOtpModal(meta) {
      els.badgeDLT.style.display = meta?.templateId && meta?.header ? 'inline-flex' : 'none';
      els.badgeToken.style.display = meta?.tokenVerified ? 'inline-flex' : 'none';
      els.attemptsLeft.textContent = String(state.maxAttempts - state.attempts);

      els.otpDialog.showModal();
      untrap = trapFocus(els.otpDialog);
      els.otpInputs = els.otpDialog.querySelectorAll('.otp-input');
      clearOtp();
      if (!autofocusDone) {
        setTimeout(()=> els.otpInputs[0].focus(), 20); autofocusDone = true;
      }
      startCooldown(state.cooldown);
    }

    els.closeOtpBtn.addEventListener('click', ()=> { if (untrap) untrap(); els.otpDialog.close(); });

    // OTP inputs behavior
    function attachOtpInputBehavior() {
      els.otpInputs = document.querySelectorAll('.otp-input');
      els.otpInputs.forEach((i, idx) => {
        i.addEventListener('input', (e) => {
          const v = i.value.replace(/[^0-9]/g,''); i.value = v.slice(-1);
          if (v && idx < els.otpInputs.length - 1) els.otpInputs[idx+1].focus();
        });
        i.addEventListener('keydown', (e) => {
          if (e.key === 'Backspace' && !i.value && idx>0) els.otpInputs[idx-1].focus();
        });
        i.addEventListener('paste', (e) => {
          const text = (e.clipboardData || window.clipboardData).getData('text');
          const digits = (text || '').replace(/\D/g,'').slice(0, state.otpLen);
          if (digits) {
            e.preventDefault();
            els.otpInputs.forEach((el, j) => el.value = digits[j] || '');
            const last = Math.min(digits.length, els.otpInputs.length) - 1; if (last >= 0) els.otpInputs[last].focus();
          }
        });
      });
    }

    attachOtpInputBehavior();

    // Submit registration
    els.regForm.addEventListener('submit', async (e) => {
      e.preventDefault(); if (!validate()) return;
      const payload = {
        businessName: els.businessName.value.trim(),
        phoneE164: els.phone.value.trim(),
        email: els.email.value.trim(),
      };
      state.formCache = payload;

      try {
        setSubmitting(true);
        let json;
        if (window.QP_MOCK) json = await mockRequestOtp();
        else json = await apiPost('/api/auth/request-mobile-otp', payload);

        // JSON shape expected: { status, reqId, tokenVerified?, templateId?, header? }
        if (json.status === 'success') {
          state.reqId = json.reqId; state.attempts = 0; els.otpErr.textContent = '';
          openOtpModal(json);
        } else {
          throw new Error(json.message || 'Unable to request OTP');
        }
      } catch (err) {
        showToast('Could not request OTP'); console.warn('OTP request error', err);
      } finally {
        setSubmitting(false);
      }
    });

    // Resend
    els.resendBtn.addEventListener('click', async () => {
      try {
        els.resendBtn.disabled = true; startCooldown(state.cooldown);
        const payload = state.formCache;
        let json;
        if (window.QP_MOCK) json = await mockRequestOtp(); else json = await apiPost('/api/auth/request-mobile-otp', payload);
        if (json.status === 'success') {
          state.reqId = json.reqId; showToast('OTP resent');
          els.badgeDLT.style.display = json?.templateId && json?.header ? 'inline-flex' : 'none';
          els.badgeToken.style.display = json?.tokenVerified ? 'inline-flex' : 'none';
        }
      } catch (e) { showToast('Resend failed'); }
    });

    // Verify
    els.verifyBtn.addEventListener('click', async () => {
      const otp = getOtpValue();
      if (otp.length !== state.otpLen) { els.otpErr.textContent = 'Enter all 6 digits'; return; }
      if (state.attempts >= state.maxAttempts) { els.otpErr.textContent = 'Attempts exceeded. Try again later.'; return; }
      els.verifyBtn.disabled = true; els.otpErr.textContent = '';
      try {
        state.attempts++; els.attemptsLeft.textContent = String(state.maxAttempts - state.attempts);
        const body = { reqId: state.reqId, otp };
        let json;
        if (window.QP_MOCK) json = await mockVerifyOtp();
        else json = await apiPost('/api/auth/verify-mobile-otp', body);

        if (json.status === 'success') {
          window.dispatchEvent(new CustomEvent('qp:otp-verified', { detail: { reqId: state.reqId } }));
          // Immediately register
          const regBody = { ...state.formCache, reqId: state.reqId, verifiedAt: new Date().toISOString() };
          let regRes;
          if (window.QP_MOCK) regRes = await mockRegister(); else regRes = await apiPost('/api/auth/register-from-viasocket', regBody);
          if (regRes.status === 'success') {
            // Persist demo session
            const session = { user: regRes.user || json.user, token: regRes.token || json.token, ts: Date.now(), demo: true };
            try { localStorage.setItem('qp_demo_session', JSON.stringify(session)); } catch {}
            if (untrap) untrap(); els.otpDialog.close();
            if (els.toggleEmailOtp.checked) {
              // secondary email verification (mock)
              els.emailDialog.showModal();
            } else {
              enterDashboard();
            }
          } else {
            els.otpErr.textContent = regRes.message || 'Registration failed';
          }
        } else {
          els.otpErr.textContent = json.message || 'Invalid OTP';
        }
      } catch (err) {
        els.otpErr.textContent = (err && err.message) || 'Verification failed';
      } finally {
        els.verifyBtn.disabled = false;
      }
    });

    // Email dialog flows (mock success)
    els.closeEmailBtn.addEventListener('click', ()=> els.emailDialog.close());
    els.emailVerifyOk.addEventListener('click', ()=> { els.emailDialog.close(); enterDashboard(); });

    function enterDashboard() {
      document.getElementById('main').hidden = true; els.dash.hidden = false; window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    // Login link toggles dashboard if token exists (demo only)
    els.loginLink.addEventListener('click', (e)=>{
      e.preventDefault();
      const s = localStorage.getItem('qp_demo_session');
      if (s) { enterDashboard(); } else { showToast('No demo session'); }
    });

    // Contact FAB
    els.fabBtn.addEventListener('click', ()=> { els.fabCard.classList.toggle('open'); });
    els.fabClose.addEventListener('click', ()=> els.fabCard.classList.remove('open'));
    els.contactForm.addEventListener('submit', async (e)=>{
      e.preventDefault();
      const body = { businessName: document.getElementById('cBiz').value.trim(), businessType: document.getElementById('cType').value.trim(), questions: document.getElementById('cQ').value.trim(), contact: document.getElementById('cContact').value.trim() };
      try {
        const res = await fetch('/api/contact', { method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify(body) });
        if (!res.ok) throw new Error('not ok');
        showToast('Sent!'); e.target.reset(); els.fabCard.classList.remove('open');
      } catch (err) {
        // graceful mailto fallback
        const subject = encodeURIComponent('Quickport CRM — Contact');
        const bodyTxt = encodeURIComponent(`Business: ${body.businessName}\nType: ${body.businessType}\nContact: ${body.contact}\nQuestions: ${body.questions}`);
        window.location.href = `mailto:crm@quickport.co.in?subject=${subject}&body=${bodyTxt}`;
        showToast('Opening email…');
      }
    });

    // Render initial sections
    renderFeatures(); renderPricing(); renderDocs();

    // Expose small dev helpers
    window.qp = { setMock(v){ window.QP_MOCK = !!v; console.log('QP_MOCK =', window.QP_MOCK); }, clearSession(){ localStorage.removeItem('qp_demo_session'); }, version: 'v3_master' };
  </script>
</body>
</html>